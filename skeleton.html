<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8' />
<title>GTHA</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.css' rel='stylesheet' />
<script src='https://npmcdn.com/@turf/turf/turf.min.js'></script>
<style>
#insetWrap {
    height:650px;
    display: block;
    width:100%;
    position: relative;
    font-family: sans-serif;
}
#mapHold {
    display: block;
    max-width:1400px;
    margin: auto;
    height:500px;
    position: relative;
    /* pointer-events:none; */
}
#map {
    height:500px;
    width:100%;
    position: absolute;
    top:0;
}

#btnHold {
    /* position: absolute; */
    display: block;
    margin: 10px auto;
    padding:20px;
    text-transform: uppercase;
    font-size:12px;
    color:#555;
    /* top: 50%;
    transform: translateY(-50%); */
    /* bottom:0; */
    /* top:10px; */
    /* left:0; */
    /* right:0; */
    width:170px;
    z-index:100;
    background:#FFF;
    border:1px solid #555;
    border-radius:3px;
    text-align:center;
}

#btnHold:hover {
    color:#000;
    border:1px solid #888;
    cursor:pointer;
}

</style>
</head>
<body>
<div id="insetWrap">
    <div id="btnHold">Connect the dots</div>
    <div id="mapHold">    
        <div id='map'></div>
    </div>
</div>
<script>

document.getElementById('btnHold').addEventListener("click", createLine);

var baseshape = {
    "type":"GeometryCollection", "geometries": [
    {"type":"LineString","coordinates":[[0.0015204575363327968,-0.004901814098710064],[0.0015053309420148837,-0.004947549551701763],[0.0014960913619794138,-0.004982480441058592],[0.0014866268106805956,-0.005029713562747807],[0.001481694571311284,-0.005065507555042933],[0.001477638673910749,-0.005125579018361812],[0.001478158507503474,-0.005173748254263205],[0.0014820229839033732,-0.005221765036077274],[0.001489213434953577,-0.00526939740876271],[0.0014996951256850291,-0.0053164152742259715],[0.0015096864015822467,-0.005351138627682613],[0.0015257964952762983,-0.005396536980019289],[0.0015557729108470573,-0.005462263792388109],[0.0015924278113289083,-0.005524513431965706],[0.0016437887471797371,-0.005565815855118819],[0.0016914792467165472,-0.005596114694633866],[0.0017506902432315825,-0.005625061089718097],[0.0018038924464584551,-0.005644085521363954],[0.0018495279786683008,-0.0056557019266956],[0.0018866474525621288,-0.005662158244321751],[0.002021151996409653,-0.005679765168278227],[0.002128011920341264,-0.005690499798105762],[0.0022351802540851702,-0.0056975157701284395],[0.0022888396575301757,-0.0056996264371421005],[0.0023962279680547543,-0.005701049948268385],[0.0025036009129751078,-0.005698742066050925],[0.0026108288776754787,-0.005692705576413895],[0.002664348031455797,-0.005688291205350236],[0.0027711159239953015,-0.005676676871857353],[0.0028243324392655655,-0.005669480414717444],[0.002930350306592969,-0.005652319778776817],[0.0030357080456924813,-0.005631486573825833],[0.0031402784745921375,-0.005607005948510357],[0.003192228959049636,-0.005593406917077972],[0.0032953820771466674,-0.00556351193690299],[0.0033974344210717577,-0.005530051591557355],[0.0034480092492721296,-0.005511996862460446]]},
    {"type":"LineString","coordinates":[[0.0020492826004346594,-0.005668453981263477],[0.0020507706042451387,-0.005547939372804701],[0.00205554088521693,-0.005427510018274495]]},
    {"type":"LineString","coordinates":[[0.002380971693894999,-0.005436897445416162],[0.0023965201185242027,-0.00552105857825896],[0.002404743416439692,-0.005606247938859287],[0.0024060048330240814,-0.005674712266028829]]},
    {"type":"LineString","coordinates":[[0.0027189190721376095,-0.005427510018274495],[0.002723582763539634,-0.005465096570437484],[0.0027252829048494062,-0.005540784121493634],[0.002716806952141698,-0.005616014794024735],[0.002706402502573068,-0.005662195696523569]]},
    {"type":"LineString","coordinates":[[0.003050608165597949,-0.00543063916065081],[0.003050608165597949,-0.005630904272760418]]},
    {"type":"LineString","coordinates":[[0.0033040686992799064,-0.0054118643063929195],[0.003313185373946756,-0.005471293351112183],[0.003314837262616799,-0.0055163706296215975],[0.0033134561264533124,-0.005546417428599911]]},
    {"type":"LineString","coordinates":[[0.0024529419688911103,-0.004338568470146409],[0.0024262517184211853,-0.0043426141137299585],[0.002383174261795538,-0.004355471577032478],[0.0023354016280749193,-0.0043804663458567655],[0.0023002771349829856,-0.004408524350290259],[0.00227884917071886,-0.004431598288837659],[0.0022603928573827693,-0.0044571115949671065],[0.002243289428685047,-0.004488767304463976],[0.0022199462926494546,-0.004547317376333025],[0.0022010659192528916,-0.004584869951838962],[0.002173889790926037,-0.004629828285440177],[0.0021494151569509882,-0.004663999277804786],[0.00210696184197361,-0.004699148141947599],[0.002076691253093855,-0.0047273027707417595],[0.002038563475866487,-0.00476710225823697],[0.0019969116355594853,-0.004813420176906871],[0.001981793040008018,-0.004837685212763318],[0.001973164044590592,-0.004866921973788306],[0.0019741831830474123,-0.004904943241086379],[0.0019950028215725054,-0.004918684110983228],[0.002020221214610386,-0.00492837314817884],[0.0020656677635707507,-0.004931269347468173],[0.0021071023643525473,-0.004918050115573799],[0.002136898587386447,-0.004895555813957435],[0.002180598652610206,-0.004868968257342438],[0.0022117915911131457,-0.004855139724412236],[0.0022552842243680152,-0.004841847096320534],[0.002305861868761216,-0.004834198844288788],[0.0023513401829949715,-0.00483403746047614],[0.00237961079959723,-0.0048371170763872335],[0.002418521402588622,-0.0048454895358727825],[0.0024683211806589673,-0.004863015472016849],[0.002535096646215281,-0.00489464805140052],[0.0025802034028479352,-0.004922080820791732],[0.0026144727272376625,-0.004946775118849485],[0.002646948797141498,-0.004973784373428922],[0.0026762930932463856,-0.005001813772475221],[0.002704018642511255,-0.005012660655603796],[0.0027384326737294636,-0.0050132794552644015],[0.0027623324337377195,-0.005005597654830931],[0.00277837277756918,-0.004995688370088572],[0.0027841574393474046,-0.004959618233461225],[0.0027842432468407935,-0.004941328718654785],[0.002776284684673129,-0.004896409835763284],[0.0027538274413148166,-0.004849886026137911],[0.002718380825839811,-0.00480619432670904],[0.002690616503026789,-0.004768791053017238],[0.002665434140832519,-0.004729602902532684],[0.002642948080295204,-0.00468880780987309],[0.00261878651562128,-0.004635836996379784],[0.002607690777411331,-0.004560573840996389],[0.002592799048948907,-0.004505474485810279],[0.002572438645751937,-0.0044521532283063395],[0.0025468162406251695,-0.004401151317774488],[0.0025299540251594943,-0.004380379036119427],[0.002498682791265191,-0.004355322647279629],[0.0024517240621193238,-0.0043362793907575576]]},
    {"type":"LineString","coordinates":[[0.003163535505923195,-0.0038030918118246246],[0.003151310601753212,-0.0037475971272407723],[0.003148040168886669,-0.003709833483167119],[0.003148332971665782,-0.0036782429652069447],[0.0031523028216963577,-0.0036405464290814047],[0.003165554263499806,-0.0035852878768793794],[0.0031865281361982698,-0.003530766242429165],[0.003206314467340444,-0.003489474983608207],[0.0032412565457547457,-0.0034303672846917968],[0.003267895034752822,-0.003393126744156605],[0.0032970598069816774,-0.003357829676025356],[0.0033452314102449835,-0.003308899464923708],[0.003380068498204593,-0.0032791867696527963],[0.0034263823283511015,-0.0032455710830522418],[0.003465428552219778,-0.0032216575019739847],[0.003516419915860908,-0.003195679317193963],[0.003582323511876351,-0.003168960485334544],[0.0036425780574550373,-0.0031495292042455557],[0.003691831332326583,-0.0031377010146450566],[0.0037543387832154104,-0.003127650963310605],[0.0037921728380463367,-0.0031241748014141594],[0.0038428000546196685,-0.003122538923328682],[0.003918319405627302,-0.0031225584981415247],[0.003968472681321699,-0.003124611264887431],[0.004035065999091934,-0.0031312320179030574],[0.004101072162950646,-0.0031422633675163244],[0.004182310005470418,-0.003162178823782917],[0.004228380606419401,-0.0031769989718080436],[0.004282750003575605,-0.0032016832697693226],[0.00432100034044316,-0.003225003328772527],[0.004362277827894085,-0.0032570488014547253],[0.004404299353200061,-0.003299469755246383],[0.0044274272612266265,-0.0033287814179524524],[0.004458910061651658,-0.003379517787383503],[0.004477750240990551,-0.003420162111229921],[0.0044946159389154874,-0.0034809320529182296],[0.004502296874204935,-0.00351799154915651],[0.004510973264590126,-0.003580458803214135],[0.004514511492321108,-0.003656046806814477],[0.0045214661052406305,-0.003691015124289963],[0.004524139288617594,-0.003731666096831498],[0.004521823753415442,-0.003767244013640674],[0.004513904025338417,-0.003807205562457568],[0.004491836842093874,-0.003864123878341784],[0.004464735208902194,-0.003907209139717486],[0.004437925552049117,-0.003937883066409839],[0.00439678139749089,-0.003961530175655218],[0.004356746711119359,-0.0039764378805722264],[0.004324288682035696,-0.003983606484475235],[0.004295947412074554,-0.003986574790603195],[0.004262708433947293,-0.0039862869238405305],[0.004234422825396558,-0.003982828199627737],[0.0041770893695591985,-0.003968532731843805],[0.004143454181188011,-0.0039576461522249735],[0.004088753539044042,-0.003935775715467934],[0.0040360848932314295,-0.003909384618446001],[0.003985821052875169,-0.0038786596675906703],[0.003956965847141017,-0.0038582336886986593],[0.0039190411149697246,-0.0038361283301679597],[0.0038846051321351424,-0.00382095173743057],[0.003830467205920032,-0.0038050812631158205],[0.003787040890605492,-0.0037986713234729242],[0.0037368894015961333,-0.0037978388685503696],[0.003616018012563187,-0.003804403911186473],[0.003558783369992546,-0.0038108283819567644],[0.003483100142076844,-0.0038237950854045953],[0.003426991140458843,-0.003836789625474109],[0.0033963486820173167,-0.0038488531777876468],[0.0033583673488829582,-0.003859745805282094],[0.003299786199765873,-0.0038685222853491086],[0.003233994570973426,-0.0038674240015109983],[0.0032112390415043723,-0.003858487693393297],[0.0031863055735688903,-0.0038394319510186015],[0.0031656407924140475,-0.0038072116250400688]]},
    {"type":"LineString","coordinates":[[0.004225565595349502,-0.0027796559826564543],[0.004305363195638052,-0.002771646177712628],[0.004385516868633401,-0.0027689623945156955],[0.0044656715290869444,-0.002771616522335278],[0.004565325413367883,-0.0027824204586248216],[0.00463439251119551,-0.00279454077429776],[0.00466820462407044,-0.002803069265562094],[0.004709713505720174,-0.002819965884892668],[0.004731474896877593,-0.002832099495309619],[0.004767668973463967,-0.002858528112749907],[0.004785852341474085,-0.0028755618373706897],[0.004811663838156421,-0.0029059164113611423],[0.004833003853325089,-0.0029395651449935036],[0.004843882588523442,-0.0029619802239925852],[0.004851893021943684,-0.0029941925235487683],[0.004858751371661465,-0.003035108778344842],[0.004862379934350146,-0.0030930598879399993],[0.004860679019137762,-0.003134512074303953],[0.004856749292668188,-0.003167471997473505],[0.004848656594082036,-0.0032081621080253396],[0.004831504707062001,-0.0032636356182954],[0.004805355183612781,-0.0033279829756653833],[0.004786441664638446,-0.003365810013549892],[0.004759326418516749,-0.0034111848764597453]]},
    {"type":"LineString","coordinates":[[0.004617959071786809,-0.005106271842312938],[0.004625050820498924,-0.0050490707461108815],[0.004643047797621215,-0.004964528029604285],[0.0046598684719393645,-0.004909397972231225],[0.0046921328056979,-0.004829208353974849],[0.004711337087623487,-0.004790474759179928],[0.0047400148370770395,-0.00474047630918458],[0.004772077010574045,-0.004692577714759641],[0.004807370511853518,-0.0046470076907627],[0.004845726815126542,-0.004603983833201124],[0.004887642620876102,-0.004564607370305156],[0.004932368853093722,-0.00452849470428022],[0.004967474738490977,-0.004503460558458754],[0.005016189024883886,-0.004472940420859747],[0.005066873176561037,-0.004445817049594061],[0.005119290711828547,-0.004422216996693361],[0.005200630182292952,-0.004393659388160615],[0.005256296310493037,-0.004379312169825905],[0.005298617804384497,-0.004371064575952873],[0.005369913600512594,-0.004362167636219408],[0.005424331250081154,-0.004358711118637286],[0.005504588055932119,-0.004355910262606639],[0.005584893647710132,-0.004355802517131194],[0.005665157680380644,-0.00435838800341553],[0.005785278316359854,-0.004367308851823813],[0.005904798284076163,-0.00438225963912237]]},
    {"type":"LineString","coordinates":[[0.003925655429857011,-0.005293880843742024],[0.00399050471017076,-0.005262141022237493],[0.004032810225458099,-0.005239177183386669],[0.004114979813779492,-0.0051890383417993475],[0.004174287374668842,-0.005147862394408199],[0.004249983020378052,-0.0050883988434440855],[0.004304030764643855,-0.005040527278212496],[0.004372199740399453,-0.004972565999466649],[0.0044356348302098765,-0.004900166178713785],[0.004455686372105761,-0.004869130777681773],[0.004474446994197382,-0.004826948352514562],[0.004486390899051329,-0.0047776036826962616],[0.004488563525593926,-0.004722277075186107],[0.004483659021971583,-0.0046856545917537806],[0.004475270534900514,-0.0046544248104862995],[0.004450479599552389,-0.00460892287161837],[0.004410331562722858,-0.004552725493615912],[0.004381431191699736,-0.004520633774587257],[0.00434985870820139,-0.00449116704484097],[0.004294384484133953,-0.00445002557392468],[0.004264641838333638,-0.004432438221625937],[0.004209918839735903,-0.004406770973240351],[0.004160827277688126,-0.004390186780037859]]},
    {"type":"LineString","coordinates":[[0.0016532083609271447,-0.006438031513138053],[0.0017268137374590925,-0.006458291527646176],[0.0018263946424448803,-0.006479342186726343],[0.0019019022673966515,-0.006490603546319065],[0.002003291989649398,-0.0064995260522288925],[0.0020541571355897226,-0.006501363685403756],[0.002141872439109155,-0.006501885422499592],[0.002215502266196198,-0.006500885112836834],[0.0022890557787208104,-0.0064973875635039886],[0.0023990577849727444,-0.006487468507499703],[0.0024720505016005497,-0.006477751750103433],[0.0025808165994669697,-0.00645854849509111],[0.0026527236173534735,-0.006442682404471267],[0.002759471651616816,-0.006414333044270234],[0.0027947166560174977,-0.006403680569289676],[0.003159365139171361,-0.0062689191741716445]]},
    {"type":"LineString","coordinates":[[0.0019174463921980598,-0.006517302922013053],[0.0019069754506338857,-0.006584036842734706],[0.0018904430294844515,-0.006667353468464595],[0.0018942707798934825,-0.006682639389092439],[0.0019081182681759384,-0.006703575423488163],[0.0019253735331361875,-0.006715481444149661]]},
    {"type":"LineString","coordinates":[[0.002237174410035867,-0.006533157203780419],[0.002223495717464154,-0.006561689582092432],[0.0022136220024148476,-0.006595423716047934],[0.0022097575202343653,-0.006626828636327338],[0.0022133929872214845,-0.0066758457397248835],[0.0022301944580077797,-0.006725889759282819],[0.002237174410035867,-0.006760401909150838]]},
    {"type":"LineString","coordinates":[[0.002496127680681364,-0.006517302922013053],[0.002507090150271095,-0.006572675924910457],[0.0025132519991927895,-0.006628786323266264],[0.002514624342870328,-0.006662633838245717],[0.0025225514838084556,-0.00669170002149225]]},
    {"type":"LineString","coordinates":[[0.002733941908825187,-0.006438031513138053],[0.0027542805224459936,-0.0065174878464085645],[0.0027630080922649886,-0.006575435288518841]]},
    {"type":"LineString","coordinates":[[0.002950617094467338,-0.006358760104250332],[0.0029502430478457204,-0.006433097517833755],[0.0029400475732165015,-0.006506733400822086]]},
    {"type":"LineString","coordinates":[[0.00456246908521992,-0.005772151678119885],[0.0046116413398040275,-0.005769726654572283],[0.004644971089208357,-0.005775940941745116],[0.00466532912500142,-0.005783143968231664],[0.004695150622040513,-0.0057992736883880555],[0.0047150453163039945,-0.005818486954043571],[0.004724038593765887,-0.0058360766179185695],[0.00472898458793525,-0.005862370693862888],[0.004723231443235867,-0.005894173870439118],[0.004712064807556808,-0.005913777027990649],[0.004693642154785188,-0.005931203381209362],[0.004673449058353705,-0.00594126401723896],[0.004624134642336835,-0.005973757249096214],[0.004572680310061748,-0.006002742994460964],[0.004532834707630967,-0.0060220954580971695],[0.004478240364362257,-0.006044616102657684],[0.004408012884118323,-0.006067341183820513],[0.0043650216498147066,-0.006078015623253701],[0.004306945293787878,-0.00608873283481169],[0.004218785786864225,-0.0060971778047737004],[0.004144972995811875,-0.006097164454840703],[0.004015496360489126,-0.0060892373139379355]]},
    {"type":"LineString","coordinates":[[0.004541330042718247,-0.006036389707983103],[0.004584911449470519,-0.006038741800953859],[0.004613287469895539,-0.0060453077729225955],[0.0046437723507607885,-0.006057301824340456],[0.004672021483299333,-0.006073890125649153],[0.004702515241793506,-0.006099806835141624],[0.0047264843547413365,-0.00611596004668406],[0.0047446083471516885,-0.0061448173261501714],[0.004748316975282772,-0.006178691619555322],[0.004736866185858725,-0.00621078680762769],[0.004713480753255952,-0.0062292312117449514],[0.004676626029328091,-0.006250440352928675],[0.004648929123555946,-0.006261392791657184],[0.0046117433294894355,-0.0062704734022277836],[0.0045608353119995825,-0.0062735119918205405],[0.004522833380529283,-0.0062689191741716445],[0.004397609502393323,-0.006276585143661354],[0.004272525934583745,-0.006286274715762651],[0.004147615376124583,-0.006297985357418177],[0.004110223693675523,-0.0063059047200454705],[0.004060581521561062,-0.0063064703980690645],[0.004034152719212553,-0.006302200330590581],[0.00398721451622225,-0.0062860302860261045],[0.003957363993609525,-0.0062689191741716445],[0.003942593836428551,-0.006247932534937272],[0.003938969939200484,-0.006233068891618266],[0.0039417610259884625,-0.006209439693221298],[0.003962274745641719,-0.006182360018820325],[0.004022194863894925,-0.0061473163183695],[0.004074306159660796,-0.006124271427548117],[0.004105204372354141,-0.006113961711276695],[0.004168754418626256,-0.006099806835141624]]},
    {"type":"LineString","coordinates":[[0.004588892888347012,-0.0062794886953498885],[0.0046282944811182735,-0.006318039841391284],[0.004654197499824679,-0.006356863422894641],[0.004668164297728286,-0.006387826287509587],[0.004671734729230966,-0.006415107225731471],[0.00466939048635291,-0.00643442204841902],[0.00465598357561751,-0.006465583165785593],[0.004644721691324943,-0.00647941958342535],[0.004612449543028199,-0.0065007848549214434],[0.004588892888347012,-0.006506733400822086],[0.004545872322853597,-0.00652715513231232],[0.004490278463535079,-0.006548415148096618],[0.004444608937158869,-0.006561909981771472],[0.0043981147559726645,-0.006572210821165668],[0.00435101901285857,-0.006579268239785177],[0.004291647840107403,-0.00658347885928711],[0.004255928560422541,-0.006583533085759762],[0.004208390123316894,-0.006580720049095241],[0.00415050827621192,-0.006586669075755807],[0.004053607786780455,-0.006590051650695861],[0.004014825660489053,-0.006589113274778527],[0.003937466886714766,-0.006583313253809733],[0.0038798011276177775,-0.00657554412451743],[0.0038226025976613584,-0.006564865767340596],[0.003800696796715593,-0.006542154372715227],[0.0037879531609007954,-0.006507204333454941],[0.0037913186149342096,-0.006471569718067902],[0.0038093906960978124,-0.006440673893426253],[0.003856258086421861,-0.006404971166816934],[0.003930723954328029,-0.006357415301432916],[0.003996129150012625,-0.006323579575382945],[0.0040366354029908,-0.006305912498320944]]},
    {"type":"LineString","coordinates":[[0.004464701013649682,-0.0065727929082179185],[0.004499135952865905,-0.006582521017230125],[0.004528291962620131,-0.006596215557488151],[0.004549297445900233,-0.0066098888730142325],[0.004580965747408884,-0.006638852415601029],[0.0045870477053653385,-0.006652559566211311],[0.00459164417576934,-0.006683576013681865],[0.004588339474097412,-0.0067042826071375345],[0.004570532959844704,-0.006736989934776283],[0.004547293563195321,-0.006755767702358651],[0.004517548619903865,-0.006765686669727238],[0.004470566532872548,-0.006785829216364032],[0.004406447047114925,-0.0068089228347843565],[0.004340910388694772,-0.006827619627836311],[0.004307704502554943,-0.006835291568868323],[0.004240608339438794,-0.00684723847497503],[0.0041558531935740935,-0.006855737070831914],[0.004087720803138909,-0.006857349846691296],[0.0040366354029908,-0.006855527599742315],[0.004004539783114852,-0.006860264841277686],[0.0039640845723486594,-0.006863029523231497],[0.003907369497420307,-0.006860976935321819],[0.0038752078964667774,-0.006856710590657145],[0.003827716072815266,-0.006846145804357933],[0.0037591854701563383,-0.006821176655919382],[0.003738933497270693,-0.006803895332788145],[0.0037234939890586917,-0.006780207573560382],[0.0037147608537649807,-0.006741404441636905],[0.003719549765465701,-0.006710196683560539],[0.0037523381884460084,-0.00668497223740465],[0.0038204202981783264,-0.006637980601708679],[0.0038735148486369435,-0.006605870806977103],[0.00390980114798076,-0.006586004809697085]]},
    {"type":"LineString","coordinates":[[0.004448846731773428,-0.006805322374139293],[0.004528772346998483,-0.0068501779632293],[0.004580965747408884,-0.006881951402675203],[0.004592202375533271,-0.006909722956901476],[0.00458535338273909,-0.006943682016707052],[0.004570737250647863,-0.006960589752559682],[0.004543972423030957,-0.006971792332639391],[0.004497876056745637,-0.006999076172061477],[0.004465675147203171,-0.007014535142102262],[0.004424042738644094,-0.00703065504748674],[0.004363744077705859,-0.007047032097116826],[0.004310798410453225,-0.007055158548165706],[0.00426622607042824,-0.007057691392529731],[0.00422160202488044,-0.0070563485020144565],[0.004151404520921387,-0.007066399648146719],[0.004094789666525209,-0.007070119282203752],[0.004038052928658183,-0.007069977888406277],[0.003981457316785533,-0.007065976122241168],[0.003925265186167222,-0.007058132534306329],[0.0038835426751557527,-0.007049749855227866],[0.003828681621956654,-0.007035281190644088],[0.0037882516535961393,-0.007021997558204246],[0.003753474060167751,-0.007017177778819502],[0.0037324772619277665,-0.007005600862593226],[0.0037119082263639422,-0.006982471819994525],[0.0037025396310804057,-0.006958888538692994],[0.003701053103276737,-0.006932156628240058],[0.003717868716446781,-0.006905487352590409],[0.003742129882823068,-0.006881750463219982],[0.0037736160949547975,-0.006863580181161941],[0.0038063070363586046,-0.0068544507524865355],[0.003830529738599485,-0.0068528852194413925]]},
    {"type":"LineString","coordinates":[[0.00447262815458781,-0.00702463993851789],[0.004484344976471214,-0.007047500094148599],[0.004489201709883446,-0.007085569026893017],[0.004483599645806931,-0.007110638680007114],[0.004475842913805789,-0.007126537815635932],[0.004453674688055002,-0.007156727095423533],[0.004425398067900805,-0.0071840724787949825],[0.004409282775464706,-0.007195394252311435],[0.004377042096515673,-0.007211564697689412],[0.004345545059679198,-0.007220711552153194],[0.00427115162502894,-0.007233683170512174],[0.0041784128162925,-0.007246129029086089],[0.0040851680694620265,-0.0072539266717585],[0.00399165021332318,-0.00725705662810237],[0.0038980927586057556,-0.007255511082744233],[0.0038358144992249044,-0.0072518846436465875],[0.0038167616894142623,-0.007255426897100369],[0.0037886574249675507,-0.00725400402878963],[0.003751358959121862,-0.0072387085558110785],[0.0037270272572867144,-0.007215868059735912],[0.0037089802442148647,-0.007177897995475211],[0.00372086878343055,-0.007140901879625845],[0.003737712592341019,-0.00711415627908595],[0.003774068231220106,-0.00708207465247891],[0.003802701686235757,-0.0070686893504917315],[0.003838456879537613,-0.007061633262603579]]},
    {"type":"LineString","coordinates":[[0.004419780548333627,-0.007201679418094455],[0.004435233618957801,-0.007206773917164643],[0.004455823673691278,-0.007221778559790566],[0.00447262815458781,-0.007254527023922065],[0.004467890137638428,-0.007285070023640734],[0.00445821823651986,-0.007303870717958912],[0.004436124240520797,-0.00732548504154256],[0.004419780548333627,-0.007333798432669842],[0.004361862885485702,-0.007379140135498253],[0.004285266366961568,-0.007429979991120419],[0.0042045452732084486,-0.007473977975217116],[0.004137407403050088,-0.007504025139704774],[0.004103095714025975,-0.007517280264171451],[0.004026640516570062,-0.007543479362811704],[0.003955676054449122,-0.007562152280101221],[0.0038833559212889082,-0.007574579309804144],[0.003824892175268173,-0.007579958930156752],[0.0037661957253578493,-0.007581253797845836],[0.0037221921457784106,-0.007579539799663272],[0.0036983864369753514,-0.007582837929617035],[0.0036694910571906745,-0.007579002640566674],[0.003638711937155572,-0.00756399122617089],[0.0036211188367782357,-0.007547618314175278],[0.003601793273784412,-0.007511456045224584],[0.00359800027108108,-0.007479129348648063],[0.0036057157783090372,-0.007451783594920104],[0.003622532079133662,-0.0074126478319114855],[0.003651061158610979,-0.0073691307555322355],[0.003683777649039958,-0.007334946744495759],[0.0037099801067418396,-0.0073146509276794764],[0.0037512583292182112,-0.007291520348007754]]},
    {"type":"LineString","coordinates":[[0.0043325819980142245,-0.007410427461091252],[0.004377963674392555,-0.007433300699373865],[0.004421286816566251,-0.007459867350062995],[0.004477912915213228,-0.007502910771267307],[0.0044838241226017395,-0.0075188876315993745],[0.004485480094947189,-0.007546262969841925],[0.0044710125803283035,-0.007582431756079938],[0.004455261150810079,-0.007598137570050941],[0.004387210792591486,-0.007636192295970042],[0.0043036062044338255,-0.007676621050293148],[0.004234456971234952,-0.007703806611593354],[0.004199234603126237,-0.007715636431558905],[0.004127694369708691,-0.007735702975940919],[0.004054964950343336,-0.007750905040379475],[0.003943528273969439,-0.007768212246254043],[0.0038731754548388293,-0.007774711757733823],[0.0037790288751410237,-0.007777735754381923],[0.0037084039729572862,-0.007775764460037737],[0.0036297805513555094,-0.007770314753554669],[0.003610266172796267,-0.0077520442763781075],[0.0036055893583895383,-0.0077228275210293445],[0.0036129728465342332,-0.007705622984566726],[0.0036323512151462995,-0.007690519771818559],[0.0037406888079673747,-0.007584824560239672]]},
    {"type":"LineString","coordinates":[[0.0043325819980142245,-0.00767730787037756],[0.004365147154509838,-0.007685690224924945],[0.004382604396381785,-0.007701575683888744],[0.004391995636310759,-0.0077209989678164856],[0.004392473313392067,-0.007750638559819154],[0.004382869344467143,-0.007779787378977922],[0.004368371238393968,-0.0078053429951484635],[0.004333610401801304,-0.007839613261186736],[0.004296355091637387,-0.00785800782991786],[0.004237618872458432,-0.00787360533936096],[0.004173799563872078,-0.00788796997375155],[0.004130890810017295,-0.007895776634008927],[0.004066101650116466,-0.00790481054960947],[0.004000943629011824,-0.007910613924333232],[0.003913770804925289,-0.007913302844049641],[0.003870165443290123,-0.007912479716027357],[0.003825177057004849,-0.00791452169998045],[0.003780143332423038,-0.00791422463203848],[0.003705316373280969,-0.00790853666003917],[0.0036312616746083585,-0.007896398767221617],[0.0035874307498302434,-0.007886055913145357],[0.0035790696839018547,-0.0078680232348595],[0.003578034824350503,-0.007853104081052472],[0.0035889977174025415,-0.0078265261729936],[0.0036099954809737087,-0.0078119702281880315],[0.00362970883483359,-0.00780942688480028],[0.003679914060775064,-0.0077830030819182805]]},
    {"type":"LineString","coordinates":[[0.004298231053949005,-0.00786491687085248],[0.004341092811956329,-0.007891389030824245],[0.004367624736014491,-0.00792030595874363],[0.004385429604268407,-0.007952115420337634],[0.004388365182922697,-0.00796891289330579],[0.004384948458510878,-0.008013334920809728],[0.004372910490502084,-0.008042886071459147],[0.004353721040515897,-0.008068380152967545],[0.00429741399698735,-0.008092547933784774],[0.004248786904684959,-0.008108150976591521],[0.00420902944410389,-0.008117578003241971],[0.004168716317712573,-0.008124239560458718],[0.003990579600994067,-0.008137905645439009],[0.0038834439514520203,-0.008141266358518404],[0.0038119848841754625,-0.00814050759763304],[0.003740591579762745,-0.008137350051287698],[0.0036468162533051947,-0.008131155516135493],[0.0036281041294975317,-0.00812630585826385],[0.0036004063643413423,-0.008110052908241492],[0.003583272456733458,-0.008090847175462572],[0.003574243084094652,-0.008073755271435834],[0.0035664572745451152,-0.008043175271815667],[0.0035687939565127464,-0.008019934251466463],[0.003585664993061428,-0.007993556349039237],[0.0036048204568464087,-0.007982031291833376],[0.003621781693895462,-0.007978539223219634],[0.0037185681611886165,-0.007934215370316883],[0.0037512583292182112,-0.007920406856891956]]},
    {"type":"LineString","coordinates":[[0.0014623426434934442,-0.0031739220698133717],[0.0014878507499849942,-0.003157765530647406],[0.0015321293949162897,-0.0031338727208557737],[0.0015689464734596889,-0.00311759359041561],[0.001626074971847426,-0.0030980839296962733],[0.0016750275129213395,-0.0030864600972478344],[0.0017048198957185193,-0.0030815497833868053],[0.001740374491441986,-0.003079850118895525],[0.0017937121806854762,-0.003081956216088219],[0.0018552515815207413,-0.003091437671062045],[0.0019067496613831313,-0.003105483756247903],[0.001948351648697804,-0.0031212488614577216],[0.0020039524839917814,-0.003149276400706476],[0.002041369517629131,-0.0031733435875763525],[0.0020938640639859337,-0.003209981561836644],[0.0021446111371898387,-0.003251107486837762],[0.0021839096294100535,-0.0032909983889450713],[0.002207732912941731,-0.003319751885118094],[0.0022346401513840593,-0.0033578849420559456],[0.002253744270020589,-0.0033899683494682735],[0.002274448996183775,-0.003431794702696953],[0.0022808647794231667,-0.0034614218025749437],[0.002285185801043314,-0.0034975359061215406],[0.0022851481610265613,-0.003546014886447253],[0.0022796819585995413,-0.0035880881816944556],[0.0022710188141459673,-0.003623413096866885],[0.0022513559245432918,-0.0036742719544712726],[0.002240036282205184,-0.0037160906542294445],[0.0022219027337223277,-0.003745159070161753],[0.002193170673197115,-0.003771231108186926],[0.0021667879203365746,-0.0037848997212883546],[0.0021243440305206336,-0.00379358615768956],[0.002080356873471237,-0.0037901291932522273],[0.0020281175384844075,-0.0037768459363977263],[0.0020009411170700143,-0.0037655481258417997],[0.00196269252903725,-0.0037435511692403087],[0.0019318684313151323,-0.0037353376546926335],[0.0018847638647333047,-0.003726993487742198],[0.0018450267150948675,-0.0037237388006922186],[0.0017971921822804529,-0.003724306942907802],[0.0016316918355236555,-0.003785888467154013]]},
    {"type":"LineString","coordinates":[[0.0020512159703257697,-0.003327055293459888],[0.002078992648254341,-0.0033319254589120064],[0.0021125814670405222,-0.0033548462666899903],[0.0021261641485720325,-0.0033763149818977103],[0.0021328592335172077,-0.0034094101844646396],[0.0021286892156544964,-0.0034344702307642096],[0.002119444907650614,-0.0034535450986029827],[0.002101246388420254,-0.003473223578712035],[0.002065316168448096,-0.0034891212111979875],[0.0020371157722034426,-0.0034891212111979875],[0.002001185552231284,-0.003473223578712035],[0.0019814717668355025,-0.003451150076846025],[0.0019698185489652148,-0.003415072209422525],[0.0019733071548670763,-0.0033842815380533665],[0.0019814717668355034,-0.003366253185360042],[0.0020034550413302364,-0.0033424821617678846],[0.0020288323032942633,-0.003330183506427236],[0.0020512159703257697,-0.003327055293459888]]},
    {"type":"LineString","coordinates":[[0.004137290108516098,-0.0033043787833999874],[0.004161229813951333,-0.003308384916148618],[0.004180511184061769,-0.0033184221620992],[0.004201602719777727,-0.0033422618064766654],[0.004209215341722011,-0.003362622688727011],[0.004210106585014301,-0.003388144557342217],[0.004204976750288845,-0.0034066421437433073],[0.004191935097511756,-0.003427113437982531],[0.0041660213833424305,-0.003445597510626613],[0.004130881364970994,-0.0034511631427554894],[0.004108558833689764,-0.003445597510626613],[0.004080144945075638,-0.003424186109815753],[0.004064875140422064,-0.0033906795816329768],[0.004064663324809046,-0.0033664079164955184],[0.004071199907675595,-0.003345676524280442],[0.004094069032970428,-0.0033184221620992],[0.004112140654025422,-0.0033088133107582185],[0.004137290108516098,-0.0033043787833999874]]}
]}

var shape = {
    "type":"FeatureCollection", "features": [
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.0020950087140249487,-0.0026475035354515328]},"properties":{"id":1}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.0014299670626641383,-0.0026475035354515328]},"properties":{"id":2}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.0014299670626641383,-0.003158332629310276]},"properties":{"id":3}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.0016034561891060887,-0.0034378428881113787]},"properties":{"id":4}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.0016034561891060887,-0.0037944594250953986]},"properties":{"id":5}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.0017094773219317252,-0.004141437677147526]},"properties":{"id":6}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.001372137353850155,-0.004748649617857083]},"properties":{"id":7}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.0019215195875829983,-0.005259478710430881]},"properties":{"id":8}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.003550389719176866,-0.005269116995197385]},"properties":{"id":9}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.00310702861826966,-0.006416072880693808]},"properties":{"id":10}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.002268497840466899,-0.00685943397862986]},"properties":{"id":11}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.0015938179043037582,-0.006570285436538031]},"properties":{"id":12}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.0018636898787690143,-0.005654648385539472]},"properties":{"id":13}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.0011504568033965513,-0.006599200290761209]},"properties":{"id":14}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.0017480304611410472,-0.007408816208094174]},"properties":{"id":15}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.0027118589413741056,-0.007418454492809788]},"properties":{"id":16}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.003550389719176866,-0.0066184768602306045]},"properties":{"id":17}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.004244346224944668,-0.005828137511120258]},"properties":{"id":18}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.005516599818852304,-0.005510074114181863]},"properties":{"id":19}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.00625874774863176,-0.004247458809680843]},"properties":{"id":20}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.006027428913375826,-0.0028306309464858222]},"properties":{"id":21}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.004976855869921792,-0.0018378876126861803]},"properties":{"id":22}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.0033190708839209325,-0.0016451219167327206]},"properties":{"id":23}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.002172114992443593,-0.0020402915934188658]},"properties":{"id":24}},
    {"type":"Feature","geometry":{"type":"Point","coordinates":[0.001757668745943378,-0.002570397257115949]},"properties":{"id":25}}
]}

var extent = [
    [-0.1,-0.1],
    [0.1,0.1]
];

var initExtent = [
    [-0.0006,-0.009],
    [0.008,-0.001]
];

var explore = false;
var initDraw = true;
var animated = false;
var rectCollection = [];

var geojsonPoint = {
    "type": "FeatureCollection",
    "features": [{
        "type": "Feature",
        "geometry": {
            "type": "LineString",
            "coordinates": [
        
            ]
        }
    }]
};

mapboxgl.accessToken = 'pk.eyJ1IjoidHdlYXRoZXJidXJuIiwiYSI6IllqeWNoS28ifQ.LX7mJDglVdZODqd25Z8aeg';
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/empty-v9',
    center: [0,0],
    bearing: 0,
    pitch:0,
    maxBounds: extent,
    minZoom: 14,
    maxZoom: 17,
    zoom: 15
});

map.fitBounds(initExtent, {padding: -20});
map.scrollZoom.disable();
var zoomControl = new mapboxgl.NavigationControl();
map.addControl(zoomControl);


function createLine() {

    document.getElementById('btnHold').removeEventListener("click", createLine);

    geojsonPoint.features[0].geometry.coordinates = [];

    let extentArray = [];

    for (let i = 0; i < shape.features.length; i++) {
        extentArray.push(shape.features[i].geometry.coordinates)
    }

    const line = turf.lineString(extentArray);
    const lineCollection = turf.featureCollection([line]);
    const lineDistance = turf.lineDistance(line);

    rectCollection = turf.featureCollection([]);

    const rects = 2000;
    const segments = lineDistance / rects;
    const units = 'kilometers';
    const speedunits = 2000;
    const speed = segments*speedunits;

    for(let i = 0; i <= rects; i++) {
        const pointonline = turf.along(line, (segments * i));
        rectCollection.features.push(pointonline);

        if (i == rects) {
            animateLine(rects,speed);
        }
    }
}


function animateLine(rects, speed) {
    for (let i = 0; i <= rects; i++) {
        (function(index) {
            animateTimeout = setTimeout(function() {
                changeCenter(index);

                var getBearing = 360/rects;
                var getDirection = 0;

                for (let p = 0; p < i; p++ ) {
                    getDirection = getDirection + getBearing;
                }
                
                if (i == rects) {
                    console.log('done drawing');
                    document.getElementById('btnHold').addEventListener("click", createLine);
                }

            }, i * speed);
        })(i);
    }
}

function changeCenter(index) {
    let centerX = rectCollection.features[index].geometry.coordinates[0];
    let centerY = rectCollection.features[index].geometry.coordinates[1];
    geojsonPoint.features[0].geometry.coordinates.push([centerX, centerY]);
    map.getSource('lineSource').setData(geojsonPoint);
}

map.on('load', function () {
    map.addSource('lineSource', {
        "type": "geojson",
        "data": geojsonPoint
    });

    map.addSource('pointSource', {
        "type": "geojson",
        "data": shape
    });

    map.addSource('shapeSource', {
        "type": "geojson",
        "data": shape
    });

    map.addSource('baseshapeSource', {
        "type": "geojson",
        "data": baseshape
    });

    map.addLayer({
      "id": "animatedPointLabel",
      "type": "symbol",
      "source": "pointSource",
      "layout": {
            "text-field": "{id}",
            "text-size": 10,
            "text-font": ["Open Sans Bold", "Arial Unicode MS Bold"],
            "text-offset": [-1, 1],
            "text-anchor": "center",
            "text-allow-overlap": true
        },
        "paint": {
            "text-halo-width": 1,
            "text-halo-color": '#FFF'
        }
    });

    map.addLayer({
      "id": "baseLine",
      "type": "line",
      "source": "baseshapeSource",
      'paint': {
            'line-opacity': 1,
            'line-color': '#555',
            'line-width': 3
       }
    });


    map.addLayer({
      "id": "animatedLine",
      "type": "line",
      "source": "lineSource",
      'paint': {
            'line-opacity': 1,
            'line-color': '#333',
            'line-width': 3.5
       }
    });

    map.addLayer({
      "id": "shapeLine",
      "type": "fill",
      "source": "shapeSource",
      'paint': {
            'fill-opacity': 1,
            'fill-color': '#d3d3d3'
       }
    });

    map.addLayer({
      "id": "animatedPoint",
      "type": "circle",
      "source": "pointSource",
      'paint': {
            'circle-radius': 5,
            'circle-color': '#333'
      }
    });
    
    console.log('map loaded');

});

</script>
</body>
</html>
